"use strict";var U=Object.defineProperty;var K=Object.getOwnPropertyDescriptor;var X=Object.getOwnPropertyNames;var z=Object.prototype.hasOwnProperty;var N=(e,t)=>{for(var i in t)U(e,i,{get:t[i],enumerable:!0})},O=(e,t,i,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of X(t))!z.call(e,r)&&r!==i&&U(e,r,{get:()=>t[r],enumerable:!(n=K(t,r))||n.enumerable});return e};var J=e=>O(U({},"__esModule",{value:!0}),e);var ie={};N(ie,{activate:()=>ee,deactivate:()=>te});module.exports=J(ie);var u=require("vscode");var l=require("vscode");var v=require("path"),f=require("vscode");var A=require("path"),p=require("vscode");function D(e){if(!p.workspace.workspaceFolders)return;let t=p.workspace.workspaceFolders[0].uri;return e?p.Uri.file(A.posix.join(t.path,e)):t}function R(e){e?p.workspace.openTextDocument(e).then(t=>{p.window.showTextDocument(t)},()=>{p.window.showInformationMessage("File not found: "+e?.fsPath)}):p.window.showInformationMessage("File Not found.")}function m(e,t){let i=p.workspace.getConfiguration("livewire-jump");return e?t?i.get(e,t):i.get(e):i}function S(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}var B=require("path"),g=require("vscode");var T;function y(){R(T)}function C(){T=void 0,g.commands.executeCommand("setContext","livewire-jump.hasView",!1),g.commands.executeCommand("setContext","livewire-jump.hasClass",!1)}function P(e,t){if(!m("view.navigation",!0)||(C(),!t))return;let i=t.document.languageId,n=g.workspace.asRelativePath(t.document.uri.path,!1);i==="blade"?(T=F(e,n))&&g.commands.executeCommand("setContext","livewire-jump.hasClass",!0):i==="php"&&(T=$(e,n))&&g.commands.executeCommand("setContext","livewire-jump.hasView",!0)}function I(e,t){let i=g.workspace.getWorkspaceFolder(t);if(!i)return;let n;if(e.bladePath)n=e.bladePath;else if(e.classPath)n=e.classPath;else return;return g.Uri.file(B.posix.join(i.uri.path,n))}function L(e,t,i){let n=w(e).find(r=>r.tag===t);return n?I(n,i):void 0}var V;function w(e){return e.workspaceState.get(j(e),[])}async function H(e,t){let n=f.workspace.getConfiguration("livewire-jump").get("view.dirs",{});V=Object.entries(n).map(([o,a])=>q(o,a));let r=[];for(let o of V){let a=await Z(o,t);r.push(...a)}await e.workspaceState.update(j(e),r),f.window.showInformationMessage(`Refreshed Views: ${r.length} items`),P(e,t)}async function W(e){await e.workspaceState.update(j(e),void 0),C(),f.window.showInformationMessage("Cleared Views")}async function Z(e,t){let i=[],n=f.workspace.getWorkspaceFolder(t.document.uri);return n&&(i.push(...await _(e,"",n.uri)),(await G(e,"",n.uri)).forEach(o=>{for(let a of i)if(a.alias===o.alias){a.classPath=o.classPath;return}i.push(o)})),i}function q(e,t){let i=e.split(/\||:/g),n=t.split("|");return{bladePath:i[0],classPath:i[1],tag:n[0],alias:n[1]}}function j(e){return`${e.extension.id}.views`}function F(e,t){let i=w(e).find(n=>n.bladePath===t);return i&&i.classPath?D(i.classPath):void 0}function $(e,t){let i=w(e).find(n=>n.classPath===t);return i&&i.bladePath?D(i.bladePath):void 0}function Q(e,t){return!!e.classPath&&t===e.classPath}async function G(e,t,i){let n=[];if(!e.classPath)return n;let r=await f.workspace.fs.readDirectory(i.with({path:v.posix.join(i.path,e.classPath,t)}));for(let[o,a]of r){let s=v.posix.join(t,o),d=v.posix.join(e.classPath,s);if(a===f.FileType.Directory&&!V.some(c=>Q(c,d)))n.push(...await G(e,s,i));else if(a===f.FileType.File&&o.endsWith(".php")){let c=S(s.replace(/\//g,".").replace(/\.php$/,"")),h={classPath:d,tag:e.tag?e.tag+c:void 0,alias:(e.alias??"")+c};n.push(h)}}return n}function Y(e,t){return!!e.bladePath&&t===e.bladePath}async function _(e,t,i){let n=[];if(!e.bladePath)return n;let r=await f.workspace.fs.readDirectory(i.with({path:v.posix.join(i.path,e.bladePath,t)}));for(let[o,a]of r){let s=v.posix.join(t,o),d=v.posix.join(e.bladePath,s);if(a===f.FileType.Directory&&!V.some(c=>Y(c,d)))n.push(...await _(e,s,i));else if(a===f.FileType.File&&o.endsWith(".blade.php")){if(e.tag?.startsWith("x-")&&o==="index.blade.php")continue;let c=s.replace(/\//g,".").replace(/\.blade\.php$/,""),h={bladePath:d,tag:e.tag?e.tag+c:void 0,alias:(e.alias??"")+c};n.push(h)}}return n}var b=class e{static TAG_REGEX=/<\/?((?:livewire:|x-)[a-z0-9][a-z0-9-\.]*)[\s\/$>]/g;context;constructor(t){this.context=t}provideCompletionItems(t,i){return m("blade.tag.completion",!0)?t.lineAt(i).text.slice(0,i.character).match(/<([a-z0-9-\.\:]*)$/i)?w(this.context).filter(o=>!!o.tag).map(o=>{let a=o.tag??"unknown",s=new l.CompletionItem(a,l.CompletionItemKind.Snippet);return a&&(s.detail="Component",s.insertText=new l.SnippetString(`${a} $0`),s.documentation=new l.MarkdownString(`Inserts a component: 

\`\`\`html
<${a} />
\`\`\``)),s}):[]:[]}provideDocumentLinks(t){if(!m("blade.tag.link",!0))return[];let i=[];for(let n=0;n<t.lineCount;n++){let r=t.lineAt(n),o;do if(o=e.TAG_REGEX.exec(r.text),o){let a=o[1],s=L(this.context,a,t.uri);if(!s)continue;let d=o[0],c=o.index+d.indexOf(a),h=new l.Position(r.lineNumber,c),k=new l.Position(r.lineNumber,c+a.length);i.push(new l.DocumentLink(new l.Range(h,k),s))}while(o)}return i}provideHover(t,i){if(!m("blade.tag.hover",!0))return null;let n=t.lineAt(i.line).text,r;for(;(r=e.TAG_REGEX.exec(n))!==null;){let o=r[1],a=r.index,s=a+o.length;if(i.character>=a&&i.character<=s){let d=new l.Range(new l.Position(i.line,a),new l.Position(i.line,s)),c=L(this.context,o,t.uri);if(!c)continue;if(c){let h=l.workspace.asRelativePath(c.fsPath);return new l.Hover(`Livewire Component: **${o}**

Path: ${h}`,d)}}}return null}};var x=require("vscode");var E=class e{static VIEW_REGEX=/(?:view|layout|#\[Layout)\(['"]([^'"]*)['"]/g;context;loadedViews=[];constructor(t){this.context=t}provideCompletionItems(t,i,n,r){return m("view.completion",!0)?t.lineAt(i).text.substring(0,i.character).match(/(?:view|layout|#\[Layout)\(['"][^'"]*$/)?w(this.context).filter(s=>!!s.bladePath).map(s=>{let d=new x.CompletionItem(s.alias,x.CompletionItemKind.File);return d.detail="Laravel View",d.documentation=`View file: ${s.alias}`,d}):[]:[]}provideDocumentLinks(t,i){if(this.loadedViews=[],!m("view.link",!0))return[];let n=[],r=t.getText(),o;for(;(o=e.VIEW_REGEX.exec(r))!==null;){let a=o[1],s=this.findView(a),d=s?I(s,t.uri):void 0;if(d){let c=o.index+o[0].indexOf(a),h=c+a.length,k=t.positionAt(c),M=t.positionAt(h);n.push(new x.DocumentLink(new x.Range(k,M),d))}}return n}provideHover(t,i,n){m("view.hover",!0)}findView(t){let i=this.loadedViews.find(n=>n.alias===t);if(!i){let n=w(this.context).filter(r=>!!r.bladePath).find(r=>r.alias===t);return n&&this.loadedViews.push(n),n}return i}};function ee(e){let t={scheme:"file",language:"blade"},i={scheme:"file",language:"php"},n=new b(e),r=new E(e);e.subscriptions.push(u.languages.registerCompletionItemProvider(t,n,"<"),u.languages.registerDocumentLinkProvider(t,n),u.languages.registerHoverProvider(t,n),u.languages.registerCompletionItemProvider(t,r,"('"),u.languages.registerCompletionItemProvider(i,r,"('"),u.languages.registerDocumentLinkProvider(t,r),u.languages.registerDocumentLinkProvider(i,r),u.commands.registerTextEditorCommand("livewire-jump.refreshViews",o=>{H(e,o)}),u.commands.registerCommand("livewire-jump.goToClass",()=>{y()}),u.commands.registerCommand("livewire-jump.goToView",()=>{y()}),u.commands.registerCommand("livewire-jump.clearViews",async()=>{await W(e)}),u.window.onDidChangeActiveTextEditor(o=>{P(e,o)}),u.workspace.onDidChangeConfiguration(o=>{o.affectsConfiguration("livewire-jump.view.navigation")&&(m("view.navigation",!0)?P(e,void 0):C())})),P(e,u.window.activeTextEditor),console.log("Livewire Jump up")}function te(){}0&&(module.exports={activate,deactivate});
