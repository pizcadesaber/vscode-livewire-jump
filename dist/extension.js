"use strict";var _=Object.defineProperty;var pe=Object.getOwnPropertyDescriptor;var de=Object.getOwnPropertyNames;var ue=Object.prototype.hasOwnProperty;var me=(r,e)=>{for(var t in e)_(r,t,{get:e[t],enumerable:!0})},he=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of de(e))!ue.call(r,i)&&i!==t&&_(r,i,{get:()=>e[i],enumerable:!(n=pe(e,i))||n.enumerable});return r};var fe=r=>he(_({},"__esModule",{value:!0}),r);var Ce={};me(Ce,{activate:()=>xe,deactivate:()=>ve});module.exports=fe(Ce);var m=require("vscode");var T=require("vscode");var f=require("vscode");var J=require("path"),w=require("vscode"),z=0;function D(){z=performance.now()}function ge(){return z!==0?Math.round(performance.now()-z):0}function V(r=!1){let e=ge();return e=e>1e3?(e/1e3).toFixed(2)+" s":e+" ms",r?`(${e})`:`${e}`}function b(...r){if(!w.workspace.workspaceFolders)return;let e=w.workspace.workspaceFolders[0].uri;return r?w.Uri.file((0,J.join)(e.path,...r.filter(t=>!!t))):e}function K(r,e){let t=r.indexOf(e),n=t>0;return n&&(r.splice(t,1),r.unshift(e)),n}async function Q(r){return w.workspace.fs.readFile(r).then(e=>Buffer.from(e).toString("utf8"))}function N(r){r?w.workspace.openTextDocument(r).then(e=>{w.window.showTextDocument(e)},()=>{w.window.showInformationMessage("File not found: "+r?.fsPath)}):w.window.showInformationMessage("File Not found.")}function h(r,e){let t=w.workspace.getConfiguration("livewire-jump");return r?e?t.get(r,e):t.get(r):t}function R(r){return r.replace(/([a-z])([A-Z])/g,"$1-$2").replace("_","-").toLowerCase()}function X(r,e){return`${r.extension.id}.${e}`}var q=require("vscode"),v=class{static Z(e){return q.Uri.file(e)}static c(e,...t){return q.Uri.joinPath(e,...t)}};var k,O=0,ee=[];async function Z(r){let e=h("blade.icon.dirs",{});if(e){D(),k=[],O=0,ee=Object.entries(e).filter(([t,n])=>!!t).map(([t,n])=>we(t,n));for(let t of ee)if(t.group){let n=b(t.path);if(n){let i=await ae(t.group,n);i&&k.push(i)}}await r.workspaceState.update(Y(r),k),f.window.showInformationMessage("Icons Refreshed: "+O+" icons "+V(!0))}}function te(r){if(k===void 0)try{k=r.workspaceState.get(Y(r),[])}catch{return f.window.showInformationMessage("Upgrading icons..."),Z(r),[]}return k}async function ne(r){k=[],await r.workspaceState.update(Y(r),void 0),f.window.showInformationMessage("Icons Cleared")}function ie(r,e){return re(te(r),[],"",e)}function re(r,e,t,n){let i=[];return r.forEach(o=>{i.push(...re(o.groups,o.icons,t+o.tag,n))}),e.forEach(o=>{let s=t+o.tag,a=new f.CompletionItem(s,f.CompletionItemKind.Snippet);a.detail="Blade Icon",a.insertText=new f.SnippetString(`${s} $0`),a.documentation=new f.MarkdownString(`Inserts a blade icon: 

\`\`\`html
<${s} />
\`\`\``),a.range=n,i.push(a)}),i}function oe(r,e){let t=te(r);if(t.length===0)return;let n=b();return n?se(t,[],n,e):void 0}function se(r,e,t,n){for(let i of r)if(n.startsWith(i.tag))return se(i.groups,i.icons,v.c(t,i.path),n.substring(i.tag.length));for(let i of e)if(i.tag===n)return{...i,uri:v.c(t,i.name)}}function Y(r){return X(r,"blade.icons")}function we(r,e){return{path:r,tag:e,group:r&&e?{path:r,tag:e,groups:[],icons:[]}:void 0}}async function ae(r,e){let t=[];try{t=await f.workspace.fs.readDirectory(e)}catch{return}for(let[n,i]of t)if(i===f.FileType.Directory){let o=await ae({path:n,tag:R(n)+".",groups:[],icons:[]},v.c(e,n));o&&r.groups.push(o)}else i===f.FileType.File&&n.endsWith(".svg")&&(O+=1,r.icons.push({name:n,tag:R(n.replace(/\.svg$/,""))}));return r.groups.length>0||r.icons.length>0?r:void 0}var S=class{constructor(e){this.S=e}I=[];g(){return/<\/?(x-[a-z0-9][a-z0-9-\.:]*)[\s\/>$]/g}provideCompletionItems(e,t){if(!h("blade.icon.completion",!0))return[];let i=e.lineAt(t).text.slice(0,t.character).match(/<([a-z0-9-\.:]*)$/i);if(!i)return[];let o=new T.Range(new T.Position(t.line,i.index+1),new T.Position(t.line,t.character));return ie(this.S,o)}provideDocumentLinks(e,t){if(!h("blade.icon.link",!0))return[];this.I=[];let n=[],i=100;for(let o=0;o<e.lineCount;o++){if(t.isCancellationRequested)return[];let s=e.lineAt(o),a=this.g(),l,p=0;for(;(l=a.exec(s.text))!==null&&p<i;){if(t.isCancellationRequested)return[];if(p++,l){let d=l[1],c=this.I.find(G=>G.tag===d);if(!c){if(c=oe(this.S,d),!c)continue;this.I.push(c)}if(!c.uri)continue;let g=l[0],P=l.index+g.indexOf(d),I=new T.Position(s.lineNumber,P),B=new T.Position(s.lineNumber,P+d.length);n.push(new T.DocumentLink(new T.Range(I,B),c.uri)),a.lastIndex===l.index&&a.lastIndex++}}}return n}};var u=require("vscode");var U=class{constructor(e,t){this.t=e;this.w=t}k=[];g(){return/<\/?([a-z0-9][a-z0-9-\.:]{3,}[a-z0-9])[\s\/>$]/g}provideCompletionItems(e,t){if(!h("blade.tag.completion",!0))return[];this.k=[];let i=e.lineAt(t).text.slice(0,t.character).match(/<([a-z0-9-\.:]*)$/);return i?this.t.l().map(s=>{let a=new u.CompletionItem(s.tag,u.CompletionItemKind.Snippet);return a.detail="Component",a.insertText=new u.SnippetString(`${s.tag} $0`),a.documentation=new u.MarkdownString(`Inserts a component: 

\`\`\`html
<${s.tag} />
\`\`\``),i.index&&(a.range=new u.Range(new u.Position(t.line,i.index+1),new u.Position(t.line,t.character))),a}):[]}provideDocumentLinks(e,t){if(!h("blade.tag.link",!0))return[];let n=[],i=100;for(let o=0;o<e.lineCount;o++){let s=e.lineAt(o),a=this.g(),l,p=0;for(;(l=a.exec(s.text))!==null&&p<i;){if(t.isCancellationRequested)return[];if(p++,l){let d=l[1],c=this.k.find(H=>H.tag===d);if(a.lastIndex===l.index&&a.lastIndex++,!c){if(c=this.t.l().find(H=>H.tag===d),!c)continue;this.k.push(c)}let g=this.w.m(c,e.uri);if(!g)continue;let P=l[0],I=l.index+P.indexOf(d),B=new u.Position(s.lineNumber,I),G=new u.Position(s.lineNumber,I+d.length);n.push(new u.DocumentLink(new u.Range(B,G),g))}}}return n}provideHover(e,t,n){if(!h("blade.tag.hover",!0))return null;let i=e.lineAt(t.line).text,o,s=this.g();for(;(o=s.exec(i))!==null;){if(n.isCancellationRequested)return null;let a=o[1],l=o.index,p=l+a.length;if(t.character>=l&&t.character<=p){let d=new u.Range(new u.Position(t.line,l),new u.Position(t.line,p)),c=this.w.M(a,e.uri);if(!c)continue;if(c){let g=u.workspace.asRelativePath(c.fsPath);return new u.Hover(`Component: **${a}**

*${g}*`,d)}}}return null}};var x=require("vscode");var $=class r{constructor(e){this.t=e}V=[];static U="(?:"+["(?:"+["#\\[Layout","@(?:"+["each","extends","include","includeIf"].join("|")+")","(?:^|[^A-Za-z0-9_:])(?:"+["view","links","layout","withView"].join("|")+")"].join("|")+`)\\(['"]([a-zA-Z0-9\\.-:]*)`].join("|")+")";provideCompletionItems(e,t,n,i){if(h("view.completion",!0)===!1)return[];let o=e.lineAt(t).text,s=RegExp(r.U+"$").exec(o.slice(0,t.character));if(!s)return[];let a=new x.Position(t.line,s.index+s[0].length-s[1].length),l=new x.Position(t.line,s.index+s[0].length),p=new x.Range(a,l);return(this.t.h()||[]).map(d=>{let c=new x.CompletionItem(`${d.name}`,x.CompletionItemKind.File);return c.detail="Blade View",c.documentation=`View: ${d.name}`,c.range=p,c})}provideDocumentLinks(e,t){if(!h("view.link",!0))return[];this.V=[];let n=[],i=e.getText(),o=100,s=0,a,l=RegExp(r.U+`['"]`,"g");for(;(a=l.exec(i))!==null&&s<o;){if(t.isCancellationRequested)return[];let p=a[1];if(p){let d=this.findView(p),c=d?b(d.bladePath):void 0;if(c){let g=a.index+a[0].indexOf(p),P=g+p.length,I=e.positionAt(g),B=e.positionAt(P);n.push(new x.DocumentLink(new x.Range(I,B),c))}l.lastIndex===a.index&&l.lastIndex++}s++}return n}provideHover(e,t,n){h("view.hover",!0)}findView(e){let t=this.V.find(n=>n.name===e);if(!t){let n=this.t.h().filter(i=>!!i.bladePath).find(i=>i.name===e);return n&&this.V.push(n),n}return t}};var E=require("vscode");var C=require("vscode");async function le(r){if(!r)return[];let e=/\bview\s*\(\s*[\'"]([a-z0-9\.-]+)[\'"]/g,t=[],n=e.exec(r);for(;n;){let i=n[1];t.includes(i)||t.push(n[1]),n=e.exec(r)}return t}var A=class{a=[];o=[];p=[];x=[];W=!1;f=[];async G(e){if(this.W){console.warn("Blade view discovery is finished");return}let t=h("view.dirs",{});if(!t)return;D(),this.f=Object.entries(t).map(([i,o])=>this.H(i,o)),this.a=[],this.o=[],this.p=[];let n=C.workspace.getWorkspaceFolder(e.document.uri);if(n){this.x=[];for(let i of this.f)await this.$(i,"",n.uri);for(let i of this.f)await this.A(i,"",n.uri),this.p.forEach(o=>{o.aliases=o.aliases.filter(s=>{let a=!1;return this.a.forEach(l=>{l.name===s&&(l.phpReferences.includes(o.path)||l.phpReferences.push(o.path),a=!0)}),a})}),this.o.forEach(o=>{this.a.some(s=>s.name===o.alias?(o.bladePath=s.bladePath,!0):!1)});for(;this.x.length>0;){let i=this.x.pop();i&&!this.o.some(o=>o.alias===i.alias)&&this.o.push(i)}return{a:this.a,o:this.o,p:this.p}}}H(e,t){let n=e.split(/\||:|\s/g),i=t.split(/\||\s/g),o=i[1],s;return o?.startsWith("x-")?s=1:o?.startsWith("livewire:")?s=2:o&&(s=3),{bladePath:n[0],phpPath:n[1],alias:i[0]??"",tag:o,componentType:s}}async A(e,t,n){if(!e.phpPath)return;let i=[];try{i=await C.workspace.fs.readDirectory(v.c(n,e.phpPath,t))}catch{return}for(let[o,s]of i){let a=[t,o].filter(p=>!!p).join("/"),l=[e.phpPath,a].filter(p=>!!p).join("/");if(s===C.FileType.Directory&&!this.f.some(p=>l===p.phpPath))await this.A(e,a,n);else if(s===C.FileType.File&&o.endsWith(".php")){let p=b(l),d=R(a.replace(/\//g,".").replace(/\.php$/,"")),c=p?await le(await Q(p)):[];c.length===0&&c.push(e.alias+d);let g={aliases:c,path:l};if(this.p.push(g),e.componentType&&e.tag){let P={phpPath:l,tag:e.tag+this._(d),alias:c[0],type:e.componentType};this.o.push(P)}}}}async $(e,t,n){if(this.a===void 0||!e.bladePath)return;let i=[];try{i=await C.workspace.fs.readDirectory(v.c(n,e.bladePath,t))}catch{return}let o=!1,s="";if(e.componentType===1&&(o=!t,!o&&(o=i.some(([a,l])=>l===C.FileType.File&&a==="index.blade.php"),i=i.filter(([a])=>a!=="index.blade.php"),!o))){let l=t.split("/").pop();l&&(l+=".blade.php",o=i.some(([p,d])=>d===C.FileType.File&&p===l),s=l)}for(let[a,l]of i){let p=[t,a].filter(c=>!!c).join("/"),d=[e.bladePath,p].filter(c=>!!c).join("/");if(l===C.FileType.Directory&&!this.f.some(c=>d===c.bladePath))this.$(e,p,n);else if(l===C.FileType.File&&a.endsWith(".blade.php")){let c=p.replace(/\//g,".").replace(/\.blade\.php$/,""),g=e.alias+c,P={bladePath:d,name:g,phpReferences:[]};if(this.a.push(P),o&&this.o!==void 0&&e.componentType&&e.tag){let I={bladePath:d,tag:e.tag+(a===s?c.substring(0,c.length-s.length+9):c),alias:g,type:e.componentType};this.x.push(I)}}}}_(e){let t=e.split(".");if(t.length<2)return e;let n=t.pop(),i=t.join(".");return t[t.length-1]===n?i:e}};var L=class{constructor(e){this.i=e}n={v:"views",C:"components",P:{b:"phpFiles"}};B=!1;h(){return this.i.R(this.n.v,[])}l(){return this.i.R(this.n.C,[])}L(){return this.i.R(this.n.P.b,[])}async z(e){if(!this.B)return console.info("Refreshing Blade views..."),this.B=!0,new A().G(e).then(t=>{if(t){let{a:n,o:i,p:o}=t;this.i.r(this.n.v,n),this.i.r(this.n.C,i),this.i.r(this.n.P.b,o),E.window.showInformationMessage(`Refreshed Views: ${n.length} views, ${i.length} components, ${o.length} classes ${V(!0)}`)}else this.i.r(this.n.v,[]),this.i.r(this.n.C,[]),this.i.r(this.n.P.b,[]),E.window.showWarningMessage(`Empty result ${V(!0)}`)}).catch(t=>{E.window.showErrorMessage(`Blade View Refresh Error: ${t} ${V(!0)}`)}).finally(()=>{this.B=!1})}async K(){return Promise.all([this.i.r(this.n.v,void 0),this.i.r(this.n.C,void 0),this.i.r(this.n.P.b,void 0)]).then(()=>{E.window.showInformationMessage("Cleared Views")})}};var j=require("vscode"),F=class{T;y;F;constructor(e){this.T=e.workspaceState,this.y=e.globalState,this.F=e.extension.id}d(e){return`${this.F}.${e}`}Y(e,t){return this.y.get(this.d(e),t)}J(e,t){return this.y.update(this.d(e),t)}async Q(){return Promise.all(this.y.keys().filter(e=>e.startsWith(this.d(""))).map(e=>this.r(e,void 0)))}R(e,t){return this.T.get(this.d(e),t)}r(e,t){return this.T.update(this.d(e),t)}async N(){return Promise.all(this.T.keys().filter(e=>e.startsWith(this.d(""))).map(e=>this.r(e,void 0))).then(()=>j.window.showInformationMessage("All indexed elements have been cleared. You need to reload the extension to reset the elements in memory.","Reload").then(e=>{e==="Reload"&&j.commands.executeCommand("workbench.action.reloadWindow")}))}};var ce=require("vscode"),M=class{constructor(e,t){this.t=e;this.w=t}q(){let e=this.t.h()[0],t=this.t.l()[0],n=this.t.L()[0];return ce.window.showInformationMessage([this.w.O(),`View: ${e.name} - ${e.bladePath};`,`Php Script: ${n.path};`,`Component: ${t.tag} - ${t.bladePath} - ${t.phpPath};`].join(`

`))}};var y=require("vscode");var W=class{constructor(e){this.t=e}e=void 0;u=void 0;s=[];O(){return this.e?"bladePath"in this.e?`Target: ${this.e.bladePath};`:"path"in this.e?`Target: ${this.e.path};`:`Target: ${this.u};`:"Target: undefined;"}j(){this.s.length===1?N(this.s[0].uri):this.s.length>1&&y.window.showQuickPick(this.s,{placeHolder:"Choose an option"}).then(e=>{e?.uri&&(this.u==="php"?(this.e=this.e,K(this.e.aliases,e.label)):this.u==="blade"&&(this.e=this.e,K(this.e.phpReferences,e.label)),N(e.uri))})}E(){this.e=void 0,this.u=void 0,this.s=[],y.commands.executeCommand("setContext","livewire-jump.hasView",!1),y.commands.executeCommand("setContext","livewire-jump.hasClass",!1)}D(e){if(!h("view.navigation",!0)||(this.E(),!e))return;let t=y.workspace.asRelativePath(e.document.uri.path,!1);e.document.languageId==="blade"||e.document.uri.path.endsWith(".blade.php")?(this.e=this.t.h().find(n=>n.bladePath===t),this.e?.phpReferences&&this.e.phpReferences.length>0&&(this.u="blade",this.e.phpReferences.forEach(n=>{let i=b(n);i&&this.s.push({label:n,description:"PHP",uri:i})})),this.s.length>0&&y.commands.executeCommand("setContext","livewire-jump.hasClass",!0)):(e.document.languageId==="php"||e.document.uri.path.endsWith(".php"))&&(this.e=this.t.L().find(n=>n.path===t),this.u="php",this.e?.aliases.forEach(n=>{let i=this.t.h().find(o=>o.name===n);if(i){let o=b(i.bladePath);o&&this.s.push({label:n,description:"View",uri:o})}}),this.s.length>0&&y.commands.executeCommand("setContext","livewire-jump.hasView",!0))}m(e,t){let n=y.workspace.getWorkspaceFolder(t);if(!n)return;let i;if(e.bladePath)i=e.bladePath;else if(e.phpPath)i=e.phpPath;else return;return v.c(n.uri,i)}M(e,t){let n=this.t.l().find(i=>i.tag===e);return n?this.m(n,t):void 0}X(e,t){let n=this.t.l().find(i=>i.alias===e);return n?this.m(n,t):void 0}ee(e,t){let n=this.t.l().find(i=>i.phpPath===e);return n?this.m(n,t):void 0}te(e,t){let n=this.t.l().find(i=>i.bladePath===e);return n?this.m(n,t):void 0}};function xe(r){let e=new F(r),t=new L(e),n=new W(t),i=new M(t,n),o={scheme:"file",language:"blade"},s={scheme:"file",language:"php",pattern:"**/*.blade.php"},a={scheme:"file",language:"php"},l=new U(t,n),p=new $(t),d=new S(r);r.subscriptions.push(m.commands.registerCommand("livewire-jump.clearIndexedItems",async()=>e.N()),m.languages.registerCompletionItemProvider([o,s],l,"<"),m.languages.registerDocumentLinkProvider([o,s],l),m.languages.registerHoverProvider([o,s],l),m.languages.registerCompletionItemProvider([o,a],p,"'",'"'),m.languages.registerDocumentLinkProvider([o,a],p),m.commands.registerTextEditorCommand("livewire-jump.refreshViews",c=>{t.z(c)}),m.commands.registerCommand("livewire-jump.goToClass",()=>{n.j()}),m.commands.registerCommand("livewire-jump.goToView",()=>{n.j()}),m.commands.registerCommand("livewire-jump.clearViews",async()=>t.K().then(()=>n.E())),m.commands.registerCommand("livewire-jump.status",async()=>i.q()),m.languages.registerCompletionItemProvider([o,s],d,"<"),m.languages.registerDocumentLinkProvider([o,s],d),m.commands.registerCommand("livewire-jump.refreshBladeIcons",async()=>Z(r)),m.commands.registerCommand("livewire-jump.clearBladeIcons",async()=>ne(r)),m.window.onDidChangeActiveTextEditor(c=>{n.D(c)}),m.workspace.onDidChangeConfiguration(c=>{c.affectsConfiguration("livewire-jump.view.navigation")&&(h("view.navigation",!0)?n.D(void 0):n.E())})),n.D(m.window.activeTextEditor),console.log("Livewire Jump up")}function ve(){}0&&(module.exports={activate,deactivate});
